package api // import "github.com/Hirogava/Go-NN-Learn/pkg/api"


FUNCTIONS

func Eval(m layers.Module, inputs []*graph.Node, targets []*graph.Node, metric func(*graph.Node, *graph.Node) float64) (float64, error)
    Eval вычисляет среднюю метрику на парах inputs/targets с использованием
    метрики metric(pred, target) -> float64. Возвращает среднюю по всем парам.
    Проверки: model != nil, metric != nil, len(inputs) == len(targets) > 0.

func LoadCheckpoint(m layers.Module, path string) error
    LoadCheckpoint загружает параметрическую часть из файла path и записывает в
    параметры модуля m. Требования: - число параметров в файле должно совпадать
    с len(m.Params()), - формы (shape) соответствующих параметров должны
    совпасть.

    Функция читает сначала длину JSON-метаданных (uint32 little-endian), затем
    JSON, затем бинарную последовательность float64 (little-endian) и копирует
    прочитанные значения в p.Value.Data.

func Predict(m layers.Module, x *graph.Node) *graph.Node
    Predict выполняет прямой проход (forward) модели m по входному узлу x и
    возвращает выходной *graph.Node. Если m или x == nil — возвращает nil.
    Predict НЕ меняет режимы train/eval; если требуется eval-mode для
    Dropout/BN, переключите режим вручную до вызова.

func SaveCheckpoint(m layers.Module, path string) error
    SaveCheckpoint сохраняет все параметры из модуля m в файл path. Формат
    файла:

        [uint32 metaLen][metaJSON][binary float64...]

    metaJSON — JSON с версией формата: { "version": 1, "params":
    [{"shape":[r,c]}, ...] } Параметры записываются в том же порядке,
    что возвращает m.Params(). Для надёжности функция сначала записывает всё во
    временный файл в той же директории, затем делает закрытие и os.Rename(tmp,
    path) — это даёт атомарную замену файла (в пределах файловой системы).

    Возвращаемые ошибки: - если какой-то параметр nil, - если возникла ошибка
    при записи файла, - если метаданные не помещаются.

